---
import Layout from "@/layouts/Layout.astro";
import { seoConfig } from "@/config/seo-config";
import Button from "@/components/ui/Button.astro";
---

<Layout title={seoConfig.contact.title} description={seoConfig.contact.description} image={seoConfig.contact.image}>
  <div class="lg:pt-24 sm:pt-24 pt-24 px-6 py-10 sm:py-12 lg:px-8">
    <div
      class="absolute inset-x-0 top-[-10rem] -z-10 transform-gpu overflow-hidden blur-3xl sm:top-[-20rem]"
      aria-hidden="true"
    >
    </div>
    <div class="mx-auto max-w-250 text-center">
      <h2 class="text-4xl font-semibold tracking-tight text-balance text-gray-900 sm:text-5xl">Contáctenos</h2>
      <p class="mt-5 text-lg/8 text-gray-600">
        Si tiene alguna pregunta sobre nuestros productos o servicios, o desea solicitar un presupuesto personalizado,
        no dude en contactar a nuestro equipo de ventas. Estaremos encantados de ayudarle.
      </p>
    </div>
    <form action="#" method="POST" class="mx-auto mt-16 max-w-xl sm:mt-16">
      <div class="grid grid-cols-1 gap-x-8 gap-y-6 sm:grid-cols-2">
        <div>
          <label for="first-name" class="block text-sm/6 font-semibold text-gray-900">Nombre</label>
          <div class="mt-2.5">
            <input
              type="text"
              name="first-name"
              id="first-name"
              autocomplete="given-name"
              class="block w-full rounded-md bg-white px-3.5 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-red-800"
            />
          </div>
        </div>
        <div>
          <label for="last-name" class="block text-sm/6 font-semibold text-gray-900">Apellidos</label>
          <div class="mt-2.5">
            <input
              type="text"
              name="last-name"
              id="last-name"
              autocomplete="family-name"
              class="block w-full rounded-md bg-white px-3.5 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-red-800"
            />
          </div>
        </div>
        <div class="sm:col-span-2">
          <label for="company" class="block text-sm/6 font-semibold text-gray-900">Empresa</label>
          <div class="mt-2.5">
            <input
              type="text"
              name="company"
              id="company"
              autocomplete="organization"
              class="block w-full rounded-md bg-white px-3.5 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-red-800"
            />
          </div>
        </div>
        <div class="sm:col-span-2">
          <label for="email" class="block text-sm/6 font-semibold text-gray-900">Email</label>
          <div class="mt-2.5">
            <input
              type="email"
              name="email"
              id="email"
              autocomplete="email"
              class="block w-full rounded-md bg-white px-3.5 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-red-800"
            />
          </div>
        </div>
        <div class="sm:col-span-2">
          <label for="phone-number" class="block text-sm/6 font-semibold text-gray-900">Teléfono</label>
          <div class="mt-2.5">
            <div
              class="flex rounded-md bg-white outline-1 -outline-offset-1 outline-gray-300 has-[input:focus-within]:outline-2 has-[input:focus-within]:-outline-offset-2 has-[input:focus-within]:outline-red-800"
            >
              <input
                type="text"
                name="phone-number"
                id="phone-number"
                class="block w-full rounded-md bg-white px-3.5 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-red-800"
              />
            </div>
          </div>
        </div>
        <div class="sm:col-span-2">
          <label for="message" class="block text-sm/6 font-semibold text-gray-900">Mensaje</label>
          <div class="mt-2.5">
            <textarea
              name="message"
              id="message"
              rows="4"
              class="block w-full rounded-md bg-white px-3.5 py-2 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-red-800"
            >
            </textarea>
          </div>
        </div>
        <div class="flex gap-x-4 sm:col-span-2">
          <div class="flex h-6 items-center">
            <input type="checkbox" id="privacy-policy-checkbox" class="hidden" role="switch" aria-checked="false" />
            <label
              for="privacy-policy-checkbox"
              class="flex w-8 flex-none cursor-pointer rounded-full bg-gray-200 p-px ring-1 ring-gray-900/5 transition-colors duration-200 ease-in-out ring-inset focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-800"
              aria-labelledby="switch-1-label"
            >
              <span
                class="size-4 translate-x-0 transform rounded-full bg-white ring-1 shadow-xs ring-gray-900/5 transition duration-200 ease-in-out"
                aria-hidden="true"
              >
              </span>
            </label>
          </div>
          <label class="text-sm/6 text-gray-600" id="switch-1-label">
            Al seleccionar esto, acepta nuestra
            <a href="/privacy" class="font-semibold text-red-800">política&nbsp;de&nbsp;privacidad</a>.
          </label>
        </div>
      </div>
      <div class="mt-10">
        <Button type="submit" text="Enviar consulta" withFull={true} />
      </div>
    </form>
  </div>
</Layout>

<style>
  #privacy-policy-checkbox:checked + label {
    background-color: #9f0812;
    border-color: #9f0812;
  }

  #privacy-policy-checkbox:checked + label span {
    transform: translateX(100%);
    background-color: white;
  }
</style>

<script>
  const form = document.querySelector("form") as HTMLFormElement;
  const privacyPolicyCheckbox = document.querySelector("#privacy-policy-checkbox") as HTMLInputElement;

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    if (!privacyPolicyCheckbox.checked) {
      alert("❌ Debes aceptar la política de privacidad antes de enviar el formulario.");
      return;
    }

    const formData = new FormData(form);
    const res = await fetch("/api/send-contact", {
      method: "POST",
      body: formData,
    });

    if (res.ok) {
      alert("✅ Consulta enviada correctamente. Gracias por contactarnos.");
      form.reset();
    } else {
      alert("❌ Ha ocurrido un error. Inténtelo más tarde.");
    }
  });
</script>
